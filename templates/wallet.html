{% extends 'base.html' %}
{% block title %}Wallet — CryptoParcel{% endblock %}
{% block content %}
<section class="section">
  <h2>Your Wallet</h2>
  <div class="card">
    <p class="balance-label">Current balance</p>
    <p class="balance-amount">${{ '%.2f'|format(balance) }}</p>
    <p class="muted">Your wallet balance is used first when you create a label. If it's not enough, you can pay the rest via crypto invoice.</p>
    <a class="btn primary" href="{{ url_for('wallet_topup') }}">Top up balance</a>
    <a class="btn secondary" href="{{ url_for('create_label') }}">Create a label</a>
  </div>

  <h3>Recent top-ups</h3>
  {% if topups %}
    <div class="grid">
    {% for p in topups %}
      <div class="card">
        <p><strong>${{ '%.2f'|format(p.amount_usd) }}</strong> via {{ p.provider|capitalize }} — {{ p.status }}</p>
        <p class="muted">{{ p.created_at.strftime('%Y-%m-%d %H:%M') }}</p>
      </div>
    {% endfor %}
    </div>
  {% else %}
    <p class="muted">No top-ups yet.</p>
  {% endif %}

  <h3>Wallet activity</h3>
  {% if logs %}
    <div class="grid">
    {% for log in logs %}
      <div class="card">
        <p>
          {% if log.amount_change >= 0 %}+{% endif %}{{ '%.2f'|format(log.amount_change) }}
          — {{ log.reason }}
        </p>
        <p class="muted">{{ log.created_at.strftime('%Y-%m-%d %H:%M') }}</p>
      </div>
    {% endfor %}
    </div>
  {% else %}
    <p class="muted">No wallet activity yet.</p>
  {% endif %}
</section>
{% endblock %}
