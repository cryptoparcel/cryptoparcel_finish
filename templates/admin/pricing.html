{% extends 'base.html' %}
{% block title %}Admin — Pricing — CryptoParcel{% endblock %}
{% block content %}
<section class="section">
  <h2>Service pricing</h2>
  <p class="muted">
    Configure base rates and markup percentages per carrier/service. These values are used
    by the <code>calculate_label_price</code> helper when computing label prices.
  </p>

  <div class="grid-2">
    <div class="card form">
      <h3>Add / update service</h3>
      <form method="POST" action="{{ url_for('admin_pricing') }}">
        <div class="field">
          <label for="carrier">Carrier</label>
          <select id="carrier" name="carrier" required>
            <option value="USPS">USPS</option>
            <option value="UPS">UPS</option>
            <option value="FedEx">FedEx</option>
          </select>
        </div>
        <div class="field">
          <label for="service_name">Service name (must match label service string)</label>
          <input id="service_name" name="service_name" type="text" required placeholder="e.g. USPS Priority Mail">
        </div>
        <div class="field">
          <label for="base_rate">Base rate (USD)</label>
          <input id="base_rate" name="base_rate" type="number" step="0.01" value="0.00">
        </div>
        <div class="field">
          <label for="markup_percent">Markup (%)</label>
          <input id="markup_percent" name="markup_percent" type="number" step="0.1" value="10.0">
        </div>
        <div class="field checkbox">
          <label>
            <input type="checkbox" name="active" checked>
            Active
          </label>
        </div>
        <button type="submit" class="btn primary">Save pricing</button>
      </form>
    </div>

    <div class="card">
      <h3>Existing service prices</h3>
      {% if services %}
        <table class="table">
          <thead>
            <tr>
              <th>Carrier</th>
              <th>Service</th>
              <th>Base rate</th>
              <th>Markup %</th>
              <th>Active</th>
            </tr>
          </thead>
          <tbody>
            {% for sp in services %}
              <tr>
                <td>{{ sp.carrier }}</td>
                <td>{{ sp.service_name }}</td>
                <td>${{ '%.2f'|format(sp.base_rate or 0.0) }}</td>
                <td>{{ '%.1f'|format(sp.markup_percent or 0.0) }}</td>
                <td>{{ 'Yes' if sp.active else 'No' }}</td>
              </tr>
            {% endfor %}
          </tbody>
        </table>
      {% else %}
        <p class="muted">No service-specific pricing rules yet.</p>
      {% endif %}
    </div>
  </div>
</section>
{% endblock %}
