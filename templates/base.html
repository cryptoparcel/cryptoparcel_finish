<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8">
  <title>{% block title %}CryptoParcel{% endblock %}</title>
  <meta name="viewport" content="width=device-width, initial-scale=1">
  
  <!-- Favicon -->
  <link rel="icon" href="{{ url_for('static', filename='favicon.ico') }}" type="image/x-icon">
  
  <!-- Main stylesheet -->
  <link rel="stylesheet" href="{{ url_for('static', filename='styles.css') }}">
  
  <!-- Your global app.js (price estimation, etc.) -->
  <script src="{{ url_for('static', filename='app.js') }}" defer></script>
</head>
<body>
<div class="cp-page">

  <header class="cp-nav">
    <div class="container cp-nav-inner">
      <div class="cp-nav-left">
        <a href="{{ url_for('index') }}" class="cp-logo-large">CryptoParcel</a>
      </div>

      <nav class="cp-nav-center">
        {% if current_user.is_authenticated %}
          <a href="{{ url_for('create_label') }}" class="cp-nav-primary">Create label</a>
          <a href="{{ url_for('orders') }}" class="cp-nav-ghost">Orders</a>
          <a href="{{ url_for('wallet') }}" class="cp-nav-ghost">Balance</a>
          <a href="{{ url_for('dashboard') }}" class="cp-nav-ghost">Dashboard</a>
          <a href="{{ url_for('settings') }}" class="cp-nav-ghost">Settings</a>
          <a href="{{ url_for('support') }}" class="cp-nav-ghost">Support</a>
        {% else %}
          <a href="{{ url_for('register') }}" class="cp-nav-primary">Create label</a>
          <a href="{{ url_for('index') }}#pricing" class="cp-nav-ghost">Pricing</a>
          <a href="{{ url_for('support') }}" class="cp-nav-ghost">Support</a>
        {% endif %}
      </nav>

      <div class="cp-nav-right">
        {% if current_user.is_authenticated %}
          <a href="{{ url_for('logout') }}" class="cp-nav-ghost">Log out</a>
        {% else %}
          <a href="{{ url_for('login') }}" class="cp-nav-ghost">Log in</a>
        {% endif %}
      </div>
    </div>
  </header>

  <main class="cp-main">
    <div class="container">
      {% with messages = get_flashed_messages(with_categories=true) %}
        {% if messages %}
          <div class="flash-messages">
            {% for category, message in messages %}
              <div class="flash {{ category }}">{{ message }}</div>
            {% endfor %}
          </div>
        {% endif %}
      {% endwith %}

      {% block content %}{% endblock %}
    </div>
  </main>

  <footer class="cp-footer">
    <div class="container cp-footer-inner">
      <div>Â© 2025 CryptoParcel</div>
      <div class="cp-footer-links">
        <a href="{{ url_for('support') }}">Support</a>
        {% if current_user.is_authenticated %}
          <a href="{{ url_for('api_keys') }}">API</a>
        {% endif %}
        <span class="cp-footer-note">USPS/UPS/FedEx names are trademarks of their owners. Not affiliated.</span>
      </div>
    </div>
  </footer>

</div>

<!-- Global scripts: loading spinner + auto-dismiss flash messages -->
<script>
// Form submit loading spinner (works on any button with id="submit-btn")
document.querySelectorAll('form').forEach(form => {
  form.addEventListener('submit', function () {
    const btn = form.querySelector('#submit-btn');
    if (btn) {
      btn.disabled = true;
      btn.querySelector('.btn-text').style.display = 'none';
      btn.querySelector('.btn-spinner').style.display = 'inline';
    }
  });
});

// Auto-dismiss flash messages after 6 seconds
document.querySelectorAll('.flash').forEach(flash => {
  setTimeout(() => {
    flash.style.transition = 'opacity 0.5s ease';
    flash.style.opacity = '0';
    setTimeout(() => flash.remove(), 500);
  }, 6000);
});
</script>

</body>
</html>
