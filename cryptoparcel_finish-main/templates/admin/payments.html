{% extends 'base.html' %}
{% block title %}Admin Payments â€” CryptoParcel{% endblock %}
{% block content %}
<section class="section">
  <h2>Payments</h2>
  <p>Filter:
    <a href="{{ url_for('admin_payments') }}">All</a> |
    <a href="{{ url_for('admin_payments', type='topup') }}">Topups</a> |
    <a href="{{ url_for('admin_payments', type='label') }}">Labels</a>
  </p>
  <table class="table">
    <tr>
      <th>ID</th><th>User</th><th>Type</th><th>Provider</th><th>Status</th><th>Amount</th><th>Created</th><th>Actions</th>
    </tr>
    {% for p in payments %}
    <tr>
      <td>{{ p.id }}</td>
      <td>{{ p.user.email if p.user else 'n/a' }}</td>
      <td>{{ p.type }}</td>
      <td>{{ p.provider }}</td>
      <td>{{ p.status }}</td>
      <td>${{ '%.2f'|format(p.amount_usd) }}</td>
      <td>{{ p.created_at.strftime('%Y-%m-%d %H:%M') }}</td>
      <td>
        <form method="POST" action="{{ url_for('admin_delete_payment', payment_id=p.id) }}" onsubmit="return confirm('Delete payment {{ p.id }}?');">
          <button class="btn small danger" type="submit">Delete</button>
        </form>
      </td>
    </tr>
    {% endfor %}
  </table>
</section>
{% endblock %}
